
# Домашнее задание к занятию «Микросервисы: принципы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

##### Ответ:

Таблица некоторых программных решений:

| Решение | Возможности |
| ------- | ----------- |
| Amazon API Gateway | Маршрутизация на основе путей и доменов, проверка авторизации с помощью JWТ, RESTful и НТТР API, терминация НТТРS |
| Azure API Management | Маршрутизация  на основе пути, проверки авторизации, терминация НТТРS, управление API и аналитика |
| Kong | Расширяемая маршрутизация, проверка авторизации с помощью различных плагинов, терминация НТТРS, поддержка микросервисов |
| Nginx Ingress Controller | Маршрутизация НТТР-трафика к кластерам Kubernetes, терминация  НТТРS, проверка авторизации с помощью IngressAuth |
| Тraefik | Динамическая  маршрутизация, проверка авторизации с помощью различных поставщиков, терминация НТТРS, поддержка микросервисов |

Сравнение возможностей программных решений:

| Функциональность | Amazon API Gateway | Azure API Management | Kong | Nginx Ingress Controller | Тraefik |
| ---------------- | ------------------ | -------------------- | ---- | ------------------------ | ------- |
| Маршрутизация | Да | Да | Да | Да | Да |
| Проверка авторизации | JWТ | JWТ и др. | Плагины | IngressAuth | Различные поставщики |
| Да | Да | Да | Да | Да | Да |

Имея возможность выбора, я бы остановил свой взгляд на Amazon **API Gateway** или **Azure API Management**, которые, кроме возможностей. указанных в требованиях, предлагают широкий набор дополнительных возможностей, таких как:
- Расширенное управление API;
- Аналитика и мониторинг;
- Поддержка различных протоколов и форматов данных.

К преимуществам этих решений можно отнести и то, что они предоставляются как управляемые сервисы, что упрощает развёртывание и обслуживание.  


---

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

##### Ответ:

Таблица возможностей различных брокеров сообщений:
| Брокер сообщений | Кластеризация | Хранение сообщений | Скорость работы | Форматы сообщений | Права доступа | Эксплуатация | 
| ---------------- | ------------- | ------------------ | --------------- | ----------------- | ------------- | ------------ |
| Apache Kafka | Да | Да | Очень высокая | Все основные | Да | Средняя |
| Apache Pulsar | Да | Да | Высокая | Все основные + расширения | Да | Средняя |
| RabbltMQ | Да | Нет (только в памяти) | Средняя | АМQР, МQТT, STOMP | Да | Средняя |
| ActiveMQ | Да | Нет (только в памяти) | Средняя | Все основные | Да | Средняя |
| NATS | Да | Нет (только в памяти) | Очень высокая | Только NATS | Нет | Простая |

Исходя из приведённой таблицы, я бы выбрал **Apache Kafka**, так как решение соответствует нашим требованиям:
- Поддерживает кластеризацию, что обеспечивает высокую доступность и отказоустойчивость;
- Хранит сообщения на диске во время обработки, что гарантирует их надежную доставку;
- Kafka известен своей высокой скоростью и низкой задержкой, что идеально подходит для потоковых приложений реального времени;
- Kafka поддерживает все основные форматы сообщений, обеспечивая гибкость для различных сценариев использования;
- Позволяет разделять права доступа к различным потокам сообщений, что повышает безопасность;
- Имеет относительно простой и интуитивно понятный интерфейс, что облегчает его развертывание и управление.

---
